<style>

  body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
    background: radial-gradient(ellipse at center, #1c1c1c 0%, #000000 100%);
    font-family: 'Courier New', monospace;
    color: #e0e0e0;
    cursor:auto;
  }

  main {
    border: 1px solid #555;
    padding: 20px;
    width: 300px;
    background-color: #111;
    box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
    opacity: 1;
    transition: all 3s;
    position: relative;
  }

  main::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(to right, #00ff88, transparent);
    animation: scan 2s linear infinite;
  }

  @keyframes scan {
    0% { transform: translateX(-100%); opacity: 0.1; }
    50% { opacity: 0.5; }
    100% { transform: translateX(100%); opacity: 0.1; }
  }

  .captcha {
    width: 100%;
    border: 2px solid #444;
    filter: grayscale(30%) contrast(110%);
  }

  .title {
    font-size: 16px;
    margin-bottom: 10px;
    color: #ff4c4c;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  p {
    font-size: 12px;
    color: #ccc;
    text-transform: uppercase;
  }

  .answer {
    width: 100%;
    padding: 8px;
    background-color: #222;
    border: 1px solid #0f0;
    color: #0f0;
    font-family: 'Courier New', monospace;
    margin-top: 10px;
  }

  .enter {
    width: 100%;
    margin-top: 10px;
    padding: 8px;
    background-color: black;
    border: 1px solid #0f0;
    color: #0f0;
    font-family: 'Courier New', monospace;
    cursor: pointer;
    transition: background 0.3s;
  }

  .enter:hover {
    background-color: #0f0;
    color: black;
  }

  .grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  margin-top: 10px;
}

.box {
  border: 2px solid #444;
  padding: 2px;
  cursor: pointer;
  filter: grayscale(50%);
  transition: transform 0.2s, filter 0.2s, border-color 0.2s;
}

.box img {
  width: 100%;
  object-fit: cover;
  height: 100%;
  display: block;
}

.box.selected {
  border-color: #0f0;
  filter: grayscale(0%) brightness(120%);
  transform: scale(1.05);
}

  .zoom-out {
  transform: scale(4);
  opacity: 0;
  transition: transform 2s ease, opacity 2s ease;
}

</style>

<main>
  <h1 class="title">Says Something</h1>
  <img class="captcha" src="keyboard-cat.jpg" alt="captcha image">
  <p>Type the text:</p>
  <input type="text" class="answer">
  <button class="enter">Enter</button>
</main>

<main id="grid-captcha" style="display: none;">
  <h1 class="title">Checkpoint Authorization</h1>
  <p>Select all valid forms of ID for entry</p>

  <div class="grid">
    <div class="box" data-correct="false"><img src="library card.webp" alt=""></div>
    <div class="box" data-correct="false"><img src="library.jpg" alt=""></div>
    <div class="box" data-correct="false"><img src="oregon.webp" alt=""></div>
    <div class="box" data-correct="true"><img src="passport.avif" alt=""></div>
    <div class="box" data-correct="false"><img src="mpassport.jpeg" alt=""></div>
    <div class="box" data-correct="true"><img src="realid.jpg" alt=""></div>
  </div>

  <button class="enter grid-submit">Submit</button>
</main>

<main id="grid-captcha-2" style="display: none;">
  <h1 class="title">Secondary Inspection</h1>
  <p>Choose the Verified Border Crossings</p>
  <div class="grid">
    <div class="box" data-correct="true"><img src="fingerprint.jpg" alt=""></div>
    <div class="box" data-correct="false"><img src="dog.jpg" alt=""></div>
    <div class="box" data-correct="true"><img src="iris.jpg" alt=""></div>
    <div class="box" data-correct="false"><img src="buspass.jpg" alt=""></div>
    <div class="box" data-correct="true"><img src="face.jpg" alt=""></div>
    <div class="box" data-correct="false"><img src="smile.jpg" alt=""></div>
  </div>
  <button class="enter grid-submit-2">Submit</button>
</main>

<script src="https://cdn.jsdelivr.net/gh/netizenorg/netnet-standard-library/build/nn.min.js"></script>
<script>
/* global nn */
let cap = Number(localStorage.getItem('cap')) || 0
  const data = [
    {
      title: 'Type the text you see in the image:',
      image: '3ntrydenied.png',
      answer: '3ntryD3n13d'
    },
    {
      title: 'Type the text you see in the image:',
      image: 'illegalalien.png',
      answer: 'i113g4l41i3n'
    },
    {
      title: 'Last One',
      image: 'grumpy-cat.jpg',
      answer: 'music'
    }
  ]

  function updateCaptcha () {
    const c = data[cap]
    nn.get('.title').content(c.title)
    nn.get('.captcha').set({ src: c.image })
    nn.get('.answer').value = ''
  }

  async function checkCaptcha () {
    localStorage.setItem('cap', cap)
    const c = data[cap]
    const text = nn.get('.answer').value
    if (text.toLowerCase() === c.answer.toLowerCase()) {
  cap++
  nn.get('main')
    .scale(4)
    .css({ opacity: 0 })
  await nn.sleep(3000)

  if (cap >= data.length) {
    // All text CAPTCHAs are done, show the grid
    document.querySelector('main').style.display = 'none'
    document.getElementById('grid-captcha').style.display = 'block'
  } else {
    updateCaptcha()
    await nn.sleep(100)
    nn.get('main')
      .scale(1)
      .css({ opacity: 1, transition: 'none' })
    await nn.sleep(100)
    nn.get('main').css({ transition: 'all 3s' })
  }
}

  }
  
 // for middle level, look down at your hands, pick which box best matches the shade within your visio

nn.get('.enter').on('click', checkCaptcha)
nn.on('load', () => {
  if (cap >= data.length) {
    // Skip to grid CAPTCHA if text CAPTCHAs already done
    document.querySelector('main').style.display = 'none'
    document.getElementById('grid-captcha').style.display = 'block'
  } else {
    updateCaptcha()
  }
})
// Grid selection toggle
document.querySelectorAll('.box').forEach(box => {
  box.addEventListener('click', () => {
    box.classList.toggle('selected')
  })
})

// Grid answer check
document.querySelector('.grid-submit').addEventListener('click', async () => {
  let allCorrect = true
  document.querySelectorAll('#grid-captcha .box').forEach(box => {
    const correct = box.getAttribute('data-correct') === 'true'
    const selected = box.classList.contains('selected')
    if (correct !== selected) allCorrect = false
  })

  if (allCorrect) {
    localStorage.setItem('captchaDone', 'true')
    const gridMain = document.getElementById('grid-captcha')
    gridMain.classList.add('zoom-out')
    await new Promise(resolve => setTimeout(resolve, 2000))
    gridMain.style.display = 'none'
    document.getElementById('grid-captcha-2').style.display = 'block'
  } else {
    alert('Checkpoint failed. Try again.')
  }
})
  document.querySelector('.grid-submit-2').addEventListener('click', () => {
  let allCorrect = true
  document.querySelectorAll('#grid-captcha-2 .box').forEach(box => {
    const correct = box.getAttribute('data-correct') === 'true'
    const selected = box.classList.contains('selected')
    if (correct !== selected) allCorrect = false
  })

  if (allCorrect) {
    alert('Checkpoint cleared. Welcome.')
  } else {
    alert('Secondary inspection failed.')
  }
})


</script>

<button onclick="localStorage.clear(); location.reload()">Reset CAPTCHA</button>

